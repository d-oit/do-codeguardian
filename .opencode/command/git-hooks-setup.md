---
title: "git-hooks-setup"
description: "Set up Git hooks for automatic CodeGuardian analysis"
category: "Git Integration"
tags: ["git", "hooks", "automation", "pre-commit", "ci"]
---

# git-hooks-setup

Set up Git hooks to automatically run CodeGuardian analysis on commits and pushes, ensuring code quality and security standards are maintained throughout the development workflow.

## Synopsis

```bash
codeguardian git-hooks-setup [OPTIONS]
```

## Description

The `git-hooks-setup` command configures Git hooks in your repository to automatically run CodeGuardian analysis. This ensures that security and code quality checks are performed before code is committed or pushed, catching issues early in the development process.

### Key Features

- **Pre-commit hooks**: Run analysis on staged files before commits
- **Pre-push hooks**: Validate entire codebase before pushing
- **Hook management**: Install, update, and remove hooks safely
- **Configuration integration**: Use existing CodeGuardian configuration
- **Selective analysis**: Only analyze relevant files based on patterns

## Options

| Option | Description | Type | Default | Required |
|--------|-------------|------|---------|----------|
| `--hook-types` | Types of hooks to install (pre-commit,pre-push,commit-msg) | string | pre-commit,pre-push | No |
| `--force` | Overwrite existing hooks without confirmation | boolean | false | No |
| `--dry-run` | Show what would be done without making changes | boolean | false | No |
| `--config` | Path to CodeGuardian configuration file | string | codeguardian.toml | No |
| `--exclude-patterns` | Additional patterns to exclude from analysis | string[] | [] | No |
| `--fail-on-warnings` | Treat warnings as failures in hooks | boolean | false | No |
| `--timeout` | Maximum time allowed for analysis in hooks (seconds) | number | 300 | No |

## Examples

### Basic Setup

```bash
# Install default hooks (pre-commit and pre-push)
codeguardian git-hooks-setup
```

### Custom Hook Configuration

```bash
# Install only pre-commit hook with custom timeout
codeguardian git-hooks-setup --hook-types pre-commit --timeout 600
```

### Force Overwrite Existing Hooks

```bash
# Overwrite existing hooks without confirmation
codeguardian git-hooks-setup --force
```

### Dry Run to Preview Changes

```bash
# Show what hooks would be installed without making changes
codeguardian git-hooks-setup --dry-run
```

### Advanced Configuration

```bash
# Setup with custom config and exclude patterns
codeguardian git-hooks-setup \
  --config ./custom-config.toml \
  --exclude-patterns "test/**" \
  --exclude-patterns "docs/**" \
  --fail-on-warnings
```

## Hook Behavior

### Pre-commit Hook

The pre-commit hook runs CodeGuardian analysis on staged files only:

```bash
#!/bin/sh
# Generated by CodeGuardian git-hooks-setup

# Get list of staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

if [ -n "$STAGED_FILES" ]; then
    echo "Running CodeGuardian analysis on staged files..."
    codeguardian check $STAGED_FILES --fail-on-issues --quiet
fi
```

### Pre-push Hook

The pre-push hook validates the entire codebase before pushing:

```bash
#!/bin/sh
# Generated by CodeGuardian git-hooks-setup

echo "Running CodeGuardian analysis before push..."
codeguardian check --fail-on-issues --quiet --parallel 4
```

## Configuration Integration

The command automatically integrates with your existing CodeGuardian configuration:

```toml
# codeguardian.toml
[git-hooks]
enabled = true
fail_on_warnings = false
timeout_seconds = 300
exclude_patterns = ["test/**", "docs/**"]
```

## Best Practices

### Security Considerations

- **Hook validation**: Always verify hook contents before installation
- **Permission management**: Ensure hooks have appropriate execution permissions
- **Remote repository**: Never commit hook files to version control
- **Trusted sources**: Only install hooks from trusted CodeGuardian installations

### Performance Optimization

- **Selective analysis**: Use `--exclude-patterns` to skip irrelevant files
- **Parallel processing**: Enable parallel analysis for faster execution
- **Timeout configuration**: Set appropriate timeouts to prevent blocking commits
- **Incremental analysis**: Only analyze changed files in pre-commit hooks

### Workflow Integration

- **CI/CD compatibility**: Ensure hooks don't conflict with CI/CD pipelines
- **Team consistency**: Use shared configuration for team-wide consistency
- **Gradual adoption**: Start with pre-commit hooks before adding pre-push
- **Monitoring**: Monitor hook execution times and failure rates

## Error Handling

### Common Errors

- **Permission denied**: Ensure hooks have execute permissions
  ```bash
  chmod +x .git/hooks/pre-commit
  ```

- **Timeout exceeded**: Increase timeout or optimize analysis scope
  ```bash
  codeguardian git-hooks-setup --timeout 600
  ```

- **Configuration not found**: Verify configuration file exists
  ```bash
  ls -la codeguardian.toml
  ```

### Troubleshooting

1. **Check hook installation**:
   ```bash
   ls -la .git/hooks/
   cat .git/hooks/pre-commit
   ```

2. **Test hook execution**:
   ```bash
   .git/hooks/pre-commit
   ```

3. **Verify CodeGuardian installation**:
   ```bash
   codeguardian --version
   ```

4. **Check configuration**:
   ```bash
   codeguardian check --config codeguardian.toml --dry-run
   ```

## Integration with CI/CD

The git hooks complement CI/CD pipelines by providing early feedback:

```yaml
# .github/workflows/ci.yml
name: CI
on: [push, pull_request]

jobs:
  codeguardian:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run CodeGuardian
        run: codeguardian check --fail-on-issues
```

## See Also

- [`codeguardian check`](../../../commands/check.md) - Primary analysis command
- [`codeguardian init`](../../../commands/init.md) - Initialize configuration
- [`codeguardian git-workflow`](git-workflow.md) - Git workflow analysis
- [Git Hooks Documentation](https://git-scm.com/docs/githooks)